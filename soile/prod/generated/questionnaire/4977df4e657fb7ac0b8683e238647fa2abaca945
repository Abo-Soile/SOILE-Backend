<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Soile Widgets</title>
  <link rel="stylesheet" href="/css/styles.css" media="screen">
  <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/dojo/1.9.0/dijit/themes/claro/claro.css">
</head>
<body class="claro">

  <h1>Soile Widgets</h1>

  <div style="width: 960px">

     
    <h2>
    dropdownmenu
    </h2>
      
    <p>
    This is a paragraph 
    <span style="font-weight:bold; ">
    this should be bold! 
    <span style="">
    this is large and blue.   </span></span>
    </p>

    <div style="margin-bottom: 1cm; display: block; width: 700px;">
     <div style="width: 345px; float: left; display: block">
       <input type="checkbox" id="id_7fffffe2" name="name_7fffffe3" value="0"  checked 
              data-dojo-type="dijit/form/CheckBox" />
       <label for="id_7fffffe2">10</label>
       <br />
       <input type="checkbox" id="id_7fffffe1" name="name_7fffffe3" value="1" 
              data-dojo-type="dijit/form/CheckBox" />
       <label for="id_7fffffe1">20</label>
       <br />
     </div>
      
     <div style="width: 345px; float: left; display: block">
       <input type="checkbox" id="id_7fffffe0" name="name_7fffffe3" value="2" 
              data-dojo-type="dijit/form/CheckBox" />
       <label for="id_7fffffe0">30</label>
       <br />
       <input type="checkbox" id="id_7fffffdf" name="name_7fffffe3" value="3" 
              data-dojo-type="dijit/form/CheckBox" />
       <label for="id_7fffffdf">40</label>
       <br />
       <input type="checkbox" id="id_7fffffde" name="name_7fffffe3" value="4" 
              data-dojo-type="dijit/form/CheckBox" />
       <label for="id_7fffffde">50</label>
       <br />
     </div>
      
    </div>
     
     

    <p style="height: 1em; clear: both;"><!-- SPACER --></p>

    <p>
      <button data-dojo-type="dijit/form/Button" type="button" id="submitButton">
        Show data
      </button>
    </p>

    <div>
      <dl id="formdata">
      </dl>
    </div>
  </div>

  </div>

  <script src="//ajax.googleapis.com/ajax/libs/dojo/1.9.1/dojo/dojo.js" 
          data-dojo-config="async: true, parseOnLoad: true">
  </script>

  <script>
    require(["dijit/form/HorizontalSlider", 
             "dijit/form/HorizontalRuleLabels", 
             "dijit/form/HorizontalRule", 
             "dijit/form/Button", 
             "dijit/form/Select",
             "dijit/form/FilteringSelect",
             "dijit/form/ComboBox",
             "dijit/form/CheckBox",
             "dijit/form/RadioButton",
             "dijit/form/NumberSpinner",
             "dijit/form/TextBox",
             "dojo/dom",
             "dojo/dom-construct", 
             "dojo/aspect", 
             "dijit/registry", 
             "dojo/on",
             "dojo/parser",
             "dojo/query",
             "dojo/cookie",
             "dojo/json",
             "dojo/ready"],
      function(HorizontalSlider, 
               HorizontalRuleLabels, 
               HorizontalRule, 
               Button, 
               Select,
               FilteringSelect,
               ComboBox,
               CheckBox,
               RadioButton,
               NumberSpinner,
               TextBox,
               dom,
               domConstruct, 
               aspect, 
               registry, 
               on,
               parser,
               query,
               cookie,
               JSON,
               ready) {

        ready(function() {
          parser.parse();

          on(dom.byId('submitButton'), "click", function() {
            var qdata = {};
            var is_checked = function(id) {
              var widget = registry.byId(id);
              return (widget.get('checked') === true ? true : false);
            };
            var widget_value = function(id) {
              return registry.byId(id).get('value');
            };
            var validate_widget = function(id) {
              return (registry.byId(id).validate() === true ? true : false);
            };
            var nonempty_text_widget = function(id) {
              var text = widget_value(id);
              return (text.length > 0);
            };
            var set_select_value = function(id, value, default_value) {
              return (is_checked(id) === true ? value : default_value);
            };
            var text_widget_value = function(id, maxlen) {
              var text = widget_value(id);
              if (maxlen > text.length) {
                return text;
              }
              return text.substring(0, maxlen);
            };

            var save_value = function(data, params, column, get_value){
              data[column] = get_value.apply({}, params);
            };

            var save_first_checked = function(data,
                                              ids, 
                                              values,
                                              column_name,
                                              default_value){
              var len = Math.min(ids.length, values.length);
              var i = 0;
              var use_default = true;
              var id, value;

              while (i < len){
                id = ids[i];
                if (is_checked(id)){
                  use_default = false;
                  value = values[i];
                  break;
                }
                i += 1;
              }
              if (use_default){
                value = default_value;
              }
              data[column_name] = value;
            };

            var save_all_checked = function(data,
                                            ids, 
                                            values,
                                            column_names,
                                            default_value){
              var len = Math.min(ids.length, values.length, column_names.length);
              var i = 0;
              var id, value, column;

              while (i < len){
                id = ids[i];
                column = column_names[i];
                if (is_checked(id)){
                  value = values[i];
                } else {
                  value = default_value;
                }
                data[column] = value;
                i += 1;
              }
            };

            var show_saved_data = function(data){
              for (var key in data){
                if (data.hasOwnProperty(key)){
                  domConstruct.create('dt', {innerHTML: key}, 'formdata');
                  domConstruct.create('dd', {innerHTML: data[key]}, 'formdata');
                }
              }
            };

            var send_questionnaire_data = function(data){
              show_saved_data(data);
              console.log(JSON.stringify(data));
            }

            domConstruct.empty('formdata');
              save_all_checked(qdata,
                               ['id_7fffffe2','id_7fffffe1','id_7fffffe0','id_7fffffdf','id_7fffffde'],
                               ['0','1','2','3','4'],
                               ['questionnaire-id:msage10','questionnaire-id:msage20','questionnaire-id:msage30','questionnaire-id:msage40','questionnaire-id:msage50'],
                               '-1');

            send_questionnaire_data(qdata);

          });
        });
      });
  </script>
</body>
</html>
